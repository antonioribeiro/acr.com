$(document).ready(function(){function s(){$.post("refresh_session.aspx",null,function(e){e!="success"&&$("#timeout").slideDown("fast")})}function d(e){var t=$("article.narrow-1col",p),r=$("article.wide-2col",p),s=$("article:first",p),o=p.width(),a=Math.floor(o/398),f=Math.floor(o/258),l=f-a<=1?f:f,h=Math.floor(o/l-58),d=h*2+58,v=Math.floor((o-h*l)/l);t.css("width",h);if(o>640){r.css("width",d);s.css("width",h)}else r.css("width",h);$(".fancybox").fancybox({autoSize:!0});if(e&&e.length>0){var m=$(e);$("[id]",".masonry").each(function(){var e=$('[id="'+this.id+'"]');e.length>1&&e[0]==this&&$(e[1]).remove()});p.imagesLoaded(function(){t.css("display","block");r.css("display","block");$("#infscr-loading").remove();p.isotope("appended",m);$("article",".calc-hover").each(function(){c($(this))})})}else if(!u){u=!0;p.imagesLoaded(function(){t.css("display","block");r.css("display","block");$("#infscr-loading").remove();i.any()&&$("body").scrollTop()==0&&window.location.pathname!="/"&&$("body").animate({scrollTop:367});var e=p.children(),s=n?!1:!0;p.empty();p.isotope({animationEngine:"best-available",itemSelector:"article",transformsEnabled:s,masonry:{gutterWidth:14}});p.append(e);p.isotope("appended",$("article"));p.isotope("reLayout");$("article",".calc-hover").each(function(){c($(this))});$(".fancybox").fancybox({autoSize:!0});new w})}else setTimeout(function(){$("article",".calc-hover").each(function(){c($(this))});p.isotope("reLayout")},500)}function b(){$("#featured .wrap").flexslider({animation:"fade",slideDirection:"horizontal",slideshow:!0,slideshowSpeed:3e3,animationDuration:600,directionNav:!0,controlNav:!1,keyboardNav:!0,mousewheel:!1,prevText:"Previous",nextText:"Next",pausePlay:!1,pauseText:"Pause",playText:"Play",randomize:!1,slideToStart:0,animationLoop:!0,pauseOnAction:!0,pauseOnHover:!1,controlsContainer:"#featured"})}function w(){if(!$("#portfolio-album").length)return;if($("#portfolio-album").hasClass("remove-portfolio"))return;var e=this;this.allItems=$(".masonry article");this.selectedItemsContainer=$("#selected-items");this.albumId=$(".masonry").attr("id").replace("album-","");this.downloadLink=$("aside .download","#portfolio-album");this.addPhoto=function(t){$.ajax({type:"POST",url:flotheme.ajax_load_url,data:{album_id:e.albumId,photo_id:t.attr("id").replace("image-",""),action:"flotheme_add_photo"},success:function(n){var r=$("<li>"),i=t.parents(".toggle").clone();e.initSidebarRemove(i);i.find(".image-switch").attr("id","selected-"+i.find(".image-switch").attr("id"));r.html(i);e.selectedItemsContainer.append(r);t.addClass("remove");e.animate(t);e.toggleDonwload()},dataType:"json"})};this.animate=function(e){e.parents(".toggle").animate({opacity:.5},300,function(){$(this).animate({opacity:1},300)})};this.initSidebarRemove=function(t){t.find(".image-switch").click(function(){e.removePhoto($("#"+$(this).attr("id").replace("selected-","")))})};this.removePhoto=function(t){$.ajax({type:"POST",url:flotheme.ajax_load_url,data:{album_id:e.albumId,photo_id:t.attr("id").replace("image-",""),action:"flotheme_remove_photo"},success:function(n){$("#selected-"+t.attr("id")).parents("li").remove();t.removeClass("remove");e.animate(t);e.toggleDonwload()},dataType:"json"})};this.isSelected=function(e){return $("#selected-"+e.attr("id")).length>0};this.click=function(t){var n=$(this);if(e.isSelected(n))return e.removePhoto(n);e.addPhoto(n)};this.toggleDonwload=function(){var t={opacity:0};e.selectedItemsContainer.find("li").length>0&&(t.opacity=1);e.downloadLink.css(t)};this.init=function(){e.allItems.each(function(){var t=$(this).find(".image-switch");$("#selected-"+t.attr("id")).length>0&&t.addClass("remove");t.click(e.click)});e.selectedItemsContainer.find("li").each(function(){e.initSidebarRemove($(this).find(".toggle"))});e.toggleDonwload()};this.init()}var e=$("#post"),t=$("article.post"),n=parseInt(flotheme.is_mobile),r=!1,i={Android:function(){return navigator.userAgent.match(/Android/i)?!0:!1},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)?!0:!1},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?!0:!1},Windows:function(){return navigator.userAgent.match(/IEMobile/i)?!0:!1},Ipad:function(){return navigator.userAgent.match(/iPad/i)?!0:!1},any:function(){return i.Android()||i.BlackBerry()||i.iOS()||i.Windows()}};i.any()&&window.location.pathname!="/"&&window.location.pathname!="/blog/"&&window.location.pathname!="/portfolio/"&&window.location.pathname!="/video/"&&$("body").scrollTop()==0&&$("body").animate({scrollTop:367});var o=$("#fullScreenHome"),u=!1;$(window).resize(function(){if(o.length<1)return;var e=$(window),t=$(".homepage-nav").outerHeight()+60,n=e.height()-$("header").height()-t,i=e.width(),s=i/1.5;i<750&&(n=s);$("#fullScreenHome").height(n);$("#fullScreenHome .wrap li").height(n);$("#fullScreenHome .wrap li .title").css("top",0);$("#fullScreenHome .wrap li .title").height(n);$("#fullScreenHome .wrap li .title").css("lineHeight",n+"px");$("#fullScreenHome .slides li .hoverTint").css({width:i,height:n});if(s<n){var u=(n*1.5-i)/-2;$("#fullScreenHome .slides li img").css({margin:"0 0 0 "+u+"px",width:"auto",height:n}).addClass("centered")}else{var u=(i/1.5-n)/-2;$("#fullScreenHome .slides li img").css({margin:u+"px 0 0 0",width:i,height:"auto"}).addClass("centered")}$(".homepage-nav-preload").removeClass("homepage-nav-preload");if(!r){r=!0;b()}}).trigger("resize");i.any()&&b();$(window).load(function(){$(window).trigger("resize")});$(".searchform label").inFieldLabels();$("#blog #posts .post ").each(function(){var e=$(this);$(".add-link",e).click(function(){$(".comment-form").hide();$(".comments-header .comments-meta").hide();$(".comments-header .add-link").show();$(".comments-header .comments-meta",e).show();$(".comments-header .add-link",e).hide();$(".comment-form",e).show().scrollTo("slow");return!1})});n;var a=$(".calc-hover"),f=!0,l=$("article",a),c=function(e){var t=e.find(".hover"),n=t.find(".centered").height(),r=t.closest("article").find(".social-hover");n>25?r.css("bottom",75):r.css("bottom","");t.width(e.innerWidth());t.height(e.innerHeight())};l.each(function(){c($(this))});var h=$("#blog"),p=$(".masonry");$(window).load(function(){var e=!1;$(window).resize(function(){e!==!1&&clearTimeout(e);e=setTimeout(d,200)});d()});p.infinitescroll({navSelector:"div.pagination",nextSelector:"div.pagination a.next",itemSelector:".masonry-container article",loading:{finishedMsg:"No more pages to load.",img:"http://i.imgur.com/6RMhx.gif"}},function(e){d(e)});$(".switch-categories-block").click(function(){var e=$(this);if($(".categories-block ul").is(":visible")){$(".categories-block ul").slideUp();e.html("Show Categories &darr;")}else{$(".categories-block ul").slideDown();e.html("Hide Categories &uarr;")}});$("#fullScreenHome .items").flexslider({animation:"fade",slideDirection:"horizontal",slideshow:!1,slideshowSpeed:3e3,animationDuration:600,directionNav:!0,controlNav:!0,keyboardNav:!0,mousewheel:!1,prevText:"Previous",nextText:"Next",pausePlay:!1,pauseText:"Pause",playText:"Play",randomize:!1,slideToStart:0,animationLoop:!0,pauseOnAction:!0,pauseOnHover:!1,controlsContainer:"#featured"});$(".fancybox").fancybox({autoSize:!0});$(".fancybox-video").fancybox({autoSize:!0,type:"iframe"});$("#blog #header .categories").dxSlider();$("#blog .wedding-blog .wrapper").dxSlider();$("a[rel=external]").each(function(){$(this).attr("target","_blank")});$("#searchform label").inFieldLabels();$(".story").fitVids();var v=$("#dropdown"),m=$(".dropdown"),g=$("#content"),y=$(".categories-block");m.length>0&&v.click(function(e){var t=$(".dropdown").height()+10;$("header").css("position")=="static"&&(t=0);e.preventDefault();if(v.hasClass("active")){g.stop(!0,!0).animate({paddingTop:0},"fast");y.stop(!0,!0).animate({paddingTop:23},"fast");v.removeClass("active");m.slideUp("fast")}else{g.stop(!0,!0).animate({paddingTop:t},"fast");y.stop(!0,!0).animate({paddingTop:t+23},"fast");v.addClass("active");m.slideDown("fast");$("body").animate({scrollTop:367})}});$.fn.initGallery=function(){$(this).each(function(){var e=$(this),t=e.find(".counter .total"),n=e.find(".counter .current");$(".wrap",e).flexslider({animation:"fade",slideDirection:"horizontal",slideshow:!1,slideshowSpeed:7e3,animationDuration:600,directionNav:!0,controlNav:!0,keyboardNav:!0,mousewheel:!0,prevText:"Previous",nextText:"Next",pausePlay:!1,pauseText:"Pause",playText:"Play",randomize:!1,slideToStart:0,animationLoop:!0,pauseOnAction:!0,pauseOnHover:!1,controlsContainer:".wrap",start:function(e){t.text(e.count)},after:function(e){n.text(e.currentSlide+1)}})})};$("#gallery").initGallery();$.fn.initPosts=function(r){typeof r=="undefined"&&(r=!1);var i={rules:{author:{required:!0},email:{required:!0,email:!0},comment:{required:!0}},ignoreTitle:!0,invalidHandler:function(e,t){$(this).find("input[type=text], textarea").blur()}},s=function(e){e.preventDefault();var t=$(this),n=t.parents(".post").find("div.comment-form");if(!n.length)return;n.scrollTo("fast").find("input[type=text], textarea").filter(":first").focus()},o=function(e,t){e.preventDefault();var n={fn:$(this),scroll:!1},r=$.extend({comments:!1,hide:!1,add_comment:!1},t);n.post=n.fn.parents(".post");n.more=n.post.find(".more");if(r.comments||r.add_comment){n.scroll=$(".share",n.post);u(n);return}if(n.more.is(":visible")){r.hide==1?n.more.hide():n.more.slideUp(400);n.post.removeClass("open-post")}else{typeof e.originalEvent!="undefined"&&(n.scroll=n.post);u(n)}},u=function(e){e.post.siblings(".open-post").find("a.toggle:first").trigger("click",{hide:!0});var t=e.post.find("span.loading");if(e.more.text()==""){e.post.addClass("post-loading");t.css("visibility","visible");e.more.load(flotheme.ajax_load_url,{action:"flotheme_load_post",id:e.post.attr("id").replace("post-","")},function(){t.remove();e.more.slideDown(400,function(){e.post.addClass("open-post");e.scroll&&e.scroll.scrollTo("fast")});e.more.find("div.actions a.leave-comment").click(s);if(flotheme.ajax_comments){e.more.find("label").inFieldLabels();e.more.find("div.comment-form form").validate(i)}})}else{e.more.slideDown(400,function(){e.post.addClass("open-post");e.scroll&&e.scroll.scrollTo("fast")});e.more.find("div.actions a.leave-comment").click(s);if(flotheme.ajax_comments){e.more.find("label").inFieldLabels();e.more.find("div.comment-form form").validate(i)}}};$(this).each(function(){var o=$(this);if(!n){$("div.actions a.leave-comment",o).click(s);if(flotheme.ajax_comments){i.submitHandler=function(e){var t=$(e),n=o.find("div.comments"),r=t.find("input[type=submit]"),i=o.find("div.messages");t.ajaxSubmit({beforeSubmit:function(){r.hide()},success:function(){t.clearForm();r.fadeIn();t.find("input[type=text], textarea").blur();n.find("ol").load(flotheme.ajax_load_url,{id:t.find("input[name=comment_post_ID]").val(),action:"flotheme_load_comments"},function(){o.find(".comments-number").text(n.find("ol>li").length>0?n.find("ol>li").length:"No comments");i.hide().html("Thank you, kindly.  We love hearing what you have to say!").slideDown("fast");setTimeout(function(){i.slideUp("fast")},1e4)})},error:function(e){var t=e.responseText.match(/<p>([^<]+)<\/p>/)[1];i.hide().html(t).slideDown("fast");r.show()}})};i.invalidHandler=function(e,t){$(e).find("input[type=submit]").show()}}$("div.comment-form form",o).each(function(e,t){$(t).find("label").inFieldLabels();$(t).validate(i)})}!r&&flotheme.ajax_open_single&&!e.length&&t.length==1&&o.find("a.toggle:first").trigger("click")})};t.initPosts();$.fn.initContact=function(){$(this).each(function(){var e=$(this),t=e.find("form");e.find("textarea").autoResize({extraSpace:0,animate:0,limit:300});var n=e.find("div.messages"),r=t.find("input[type=submit]");t.validate({beforeSubmit:function(){r.hide()},submitHandler:function(e){$.post(flotheme.ajax_load_url,t.serialize()+"&action=flotheme_submit_contact",function(e){if(e.error){alert(e.msg);return}r.show();t.clearForm();n.hide().text(e.msg).slideDown("fast");setTimeout(function(){n.slideUp("fast")},1e4)},"json")}})})};$.fn.initArchives=function(){$(this).each(function(){var e=$(this),t=$("#archives-active-year"),n=$("div.months div.year-months",e),r=$("a.up, a.down",e),i,s,o,u=!1;r.click(function(e){e.preventDefault();if(u)return;var i=$(this);u=!0;r.css("visibility","visible");var s=n.filter(".year-active");if(i.hasClass("up")){o=s.prev();o.length||(o=n.filter(":last"))}else{o=s.next();o.length||(o=n.filter(":first"))}s.removeClass("year-active").fadeOut("fast",function(){o.addClass("year-active").fadeIn("fast",function(){u=!1});t.text(o.attr("id").replace(/[^0-9]*/,""));i.hasClass("up")?o.prev().length||r.filter(".up").css("visibility","hidden"):o.next().length||r.filter(".down").css("visibility","hidden")})});i=n.filter(":first").addClass("year-active");n.not(":first").hide();t.text(i.attr("id").replace(/[^0-9]*/,""));n.length<2?r.css("visibility","hidden"):r.filter(".up").css("visibility","hidden")})};$(".archives").initArchives();$("#contact div.contact").initContact();$("#blog-categories-toggle").click(function(){var e=$("#categories-panel"),t=$(".full-line");e.is(":visible")?e.slideUp("fast",function(){t.hide()}):e.slideDown("fast",function(){t.show()})});$("aside .toggler .toggle").click(function(){$(this).parents(".toggler").toggleClass("active")});$('#overlay, .modal input[type="submit"], .close').click(function(){function e(){$("#overlay, .modal").addClass("hidden")}$("#overlay, .modal").animate({opacity:0},50,function(){});setTimeout(e,200)})});